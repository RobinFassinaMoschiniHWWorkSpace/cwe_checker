<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="This module implements a check for CWE-119: Buffer Overflow and its variants CWE-125: Out-of-bounds Read and CWE-787: Out-of-bounds Write."><title>cwe_checker_lib::checkers::cwe_119 - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-ba5701c5741a7b69.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="cwe_checker_lib" data-themes="" data-resource-suffix="" data-rustdoc-version="1.70.0 (90c541806 2023-05-31)" data-search-js="search-e077946657036a58.js" data-settings-js="settings-298e1ea74db45b39.js" data-settings-css="settings-7bfb4c59cc6bc502.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../../../static.files/storage-62ce34ea385b278a.js"></script><script defer src="../../../static.files/main-f61008743c98d196.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../../cwe_checker_lib/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../../cwe_checker_lib/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module cwe_119</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#statics">Statics</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../../index.html">cwe_checker_lib</a>::<wbr><a href="../index.html">checkers</a>::<wbr><a class="mod" href="#">cwe_119</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../../src/cwe_checker_lib/checkers/cwe_119/mod.rs.html#1-94">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>This module implements a check for CWE-119: Buffer Overflow
and its variants CWE-125: Out-of-bounds Read and CWE-787: Out-of-bounds Write.</p>
<p>Arrays or buffers of any kind are often accessed through indices.
If the index of an access is outside of the bounds of the buffer this can lead to severe consequences.
In the case of out-of-bounds read accesses this often leads to exposure of sensitive information to an attacker.
Out-of-bounds write accesses can often be used to hijack the control flow of a program
and thus may lead to arbitrary code execution.</p>
<p>See <a href="https://cwe.mitre.org/data/definitions/119.html">https://cwe.mitre.org/data/definitions/119.html</a> for a detailed description.</p>
<h3 id="how-the-check-works"><a href="#how-the-check-works">How the check works</a></h3>
<p>The check uses the results of the <a href="../../analysis/pointer_inference/index.html" title="mod cwe_checker_lib::analysis::pointer_inference">Pointer Inference analysis</a>
to check whether any memory accesses may point outside of the bounds of the corresponding memory objects.
For this the results of the Pointer Inference analysis are aggregated interprocedurally.
Additionally, the check uses a lightweight intraprocedural dataflow fixpoint computation
to ensure that for each memory object only the first access outside of its bounds is flagged as a CWE.</p>
<h3 id="false-positives"><a href="#false-positives">False Positives</a></h3>
<ul>
<li>Any analysis imprecision of the Pointer Inference analysis may lead to false positive results in this check.</li>
<li>If no exact bounds for a memory object could be inferred then the strictest (smallest) bounds found are used,
which can lead to false positive warnings.</li>
</ul>
<h3 id="false-negatives"><a href="#false-negatives">False Negatives</a></h3>
<ul>
<li>In cases where the Pointer Inference analysis could not infer any bounds at all for the memory object or the access index
this check generally assumes analysis imprecision as the culprit and will not flag them as CWEs.
This leads to false negatives, especially in cases where the bounds directly depend on user input.</li>
<li>The Pointer Inference analysis cannot distinguish different objects located on the same stack frame.
Thus buffer overflows on the stack can only be detected if they may reach outside of the whole stack frame.
This leads to false negatives, especially for buffer overflows caused by off-by-one bugs.</li>
<li>For parameters of extern calls where a corresponding call stub is defined
the analysis approximates size parameters as small as possible, which can lead to false negatives.
Currently, analysis imprecision would lead to too many false positives if we would approximate by larger possible size parameters.</li>
<li>For parameters of extern function calls without corresponding function stubs
the check only checks whether the parameter itself may point outside of the boundaries of a memory object.
But since we generally do not know what size the called function expects the pointed-to object to have
this still may miss buffer overflows occuring in the called function.</li>
<li>Right now the check only considers buffers on the stack or the heap, but not buffers in global memory.
Thus corresponding overflows of buffers in global memory are not detected.</li>
</ul>
</div></details><h2 id="statics" class="small-section-header"><a href="#statics">Statics</a></h2><ul class="item-table"><li><div class="item-name"><a class="static" href="static.CWE_MODULE.html" title="static cwe_checker_lib::checkers::cwe_119::CWE_MODULE">CWE_MODULE</a></div><div class="desc docblock-short">The module name and version</div></li></ul><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.check_cwe.html" title="fn cwe_checker_lib::checkers::cwe_119::check_cwe">check_cwe</a></div><div class="desc docblock-short">Run the check for CWE-119: Buffer Overflows.</div></li></ul></section></div></main></body></html>