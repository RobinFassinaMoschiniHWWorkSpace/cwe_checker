<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="This module implements a check for CWE-78: Improper Neutralization of Special Elements used in an OS Command (‘OS Command Injection’)."><meta name="keywords" content="rust, rustlang, rust-lang, cwe_78"><title>cwe_checker_lib::checkers::cwe_78 - Rust</title><link rel="stylesheet" type="text/css" href="../../../normalize.css"><link rel="stylesheet" type="text/css" href="../../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../../ayu.css" disabled ><script id="default-settings"></script><script src="../../../storage.js"></script><script src="../../../crates.js"></script><noscript><link rel="stylesheet" href="../../../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../../../favicon.svg">
<link rel="alternate icon" type="image/png" href="../../../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../../../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../../../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../../../cwe_checker_lib/index.html'><div class='logo-container rust-logo'><img src='../../../rust-logo.png' alt='logo'></div></a><p class="location">Module cwe_78</p><div class="sidebar-elems"><div class="block items"><ul><li><a href="#structs">Structs</a></li><li><a href="#statics">Statics</a></li><li><a href="#functions">Functions</a></li></ul></div><p class="location"><a href="../../index.html">cwe_checker_lib</a>::<wbr><a href="../index.html">checkers</a></p><div id="sidebar-vars" data-name="cwe_78" data-ty="mod" data-relpath="../"></div><script defer src="../sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../../../brush.svg" width="18" height="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" class="help-button">?</button>
                <a id="settings-menu" href="../../../settings.html"><img src="../../../wheel.svg" width="18" height="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Module <a href="../../index.html">cwe_checker_lib</a>::<wbr><a href="../index.html">checkers</a>::<wbr><a class="mod" href="">cwe_78</a><button id="copy-path" onclick="copy_path(this)">⎘</button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../../src/cwe_checker_lib/checkers/cwe_78.rs.html#1-305" title="goto source code">[src]</a></span></h1><div class="docblock"><p>This module implements a check for CWE-78: Improper Neutralization of Special Elements used in an OS Command (‘OS Command Injection’).</p>
<p>The software constructs all or part of an OS command using externally-influenced input from an upstream component,
but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command
when it is sent to a downstream component.</p>
<p>See <a href="https://cwe.mitre.org/data/definitions/78.html">https://cwe.mitre.org/data/definitions/78.html</a> for a detailed description.</p>
<h2 id="how-the-check-works" class="section-header"><a href="#how-the-check-works">How the check works</a></h2>
<p>Using backward dataflow analysis we search for an executation path from a system call parameter (string) to an user input
to identify possible command injections.</p>
<p>To find relevant string related functions, such as sprintf, it is assumed that the first input parameter points
to the memory position that will be used as the return location. (e.g. char *strcat(char *dest, const char *src)
where ‘char *dest’ will contain the return value)</p>
<p>For instance:</p>
<pre><code class="language-txt">MOV RAX, qword ptr [RBP + local_10]
MOV RDI, RAX                        // RDI is the first input parameter for the strcat call and it points to [RBP + local_10]
CALL strcat
MOV RAX, qword ptr [RBP + local_10] // In the backwards analysis [RBP + local_10] will be tainted and it contains the return value
</code></pre>
<h3 id="symbols-configurable-in-configjson" class="section-header"><a href="#symbols-configurable-in-configjson">Symbols configurable in config.json</a></h3>
<p>The symbols are the functions which</p>
<ol>
<li>make system calls (e.g. system)</li>
<li>manipulate strings (e.g. sprintf, strcat, memcpy, etc.)</li>
<li>take user input (e.g. scanf)</li>
</ol>
<h2 id="false-positives" class="section-header"><a href="#false-positives">False Positives</a></h2>
<ul>
<li>The input comes from the user but proper sanitization was not detected by the analysis even though it exists.</li>
<li>The input comes from the user but the format string’s input format could not be distinguished as non-string input.</li>
</ul>
<h2 id="false-negatives" class="section-header"><a href="#false-negatives">False Negatives</a></h2>
<ul>
<li>Missing Taints due to lost track of pointer targets</li>
<li>Non tracked function parameters cause incomplete taints that could miss possible dangerous inputs</li>
</ul>
</div><h2 id="structs" class="section-header"><a href="#structs">Structs</a></h2>
<table><tr class="module-item"><td><a class="struct" href="struct.BlockMaps.html" title="cwe_checker_lib::checkers::cwe_78::BlockMaps struct">BlockMaps</a></td><td class="docblock-short"><p>
<li>block_first_def_set:
- A set containing a given <a href="../../intermediate_representation/enum.Def.html"><code>Def</code></a> as the first <code>Def</code> of the block.
The keys are of the form <code>(Def-TID, Current-Sub-TID)</code>
to distinguish the nodes for blocks contained in more than one function.</li>
<li>block_start_last_def_map:
- A map to get the node index of the <code>BlkStart</code> node
containing a given <a href="../../intermediate_representation/enum.Def.html"><code>Def</code></a> as the last <code>Def</code> of the block.
The keys are of the form <code>(Def-TID, Current-Sub-TID)</code>
to distinguish the nodes for blocks contained in more than one function.</li>
<li>jmp_to_blk_end_node_map:
- A map to get the node index of the <code>BlkEnd</code> node containing a given <a href="../../intermediate_representation/enum.Jmp.html" title="Jmp"><code>Jmp</code></a>.
The keys are of the form <code>(Jmp-TID, Current-Sub-TID)</code>
to distinguish the nodes for blocks contained in more than one function.</li>
</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.Config.html" title="cwe_checker_lib::checkers::cwe_78::Config struct">Config</a></td><td class="docblock-short"><p>The configuration struct</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.SymbolMaps.html" title="cwe_checker_lib::checkers::cwe_78::SymbolMaps struct">SymbolMaps</a></td><td class="docblock-short"><p>
<li>string_symbols:
<p>
<li>Maps the TID of an extern string related symbol to the corresponding extern symbol struct.</li>
</p>
</li>
<li>user_input_symbols:
<p>
<li>Maps the TID of an extern symbol that take input from the user to the corresponding extern symbol struct.</li>
</p>
</li>
<li>extern_symbol_map:
<p>
<li>Maps the TID of an extern symbol to the extern symbol struct.</li>
</p>
</li>
<li>format_string_index:
<p>
<li>Maps a symbol name to the index of its format string parameter.</li>
</p>
</li>
</p>
</td></tr></table><h2 id="statics" class="section-header"><a href="#statics">Statics</a></h2>
<table><tr class="module-item"><td><a class="static" href="static.CWE_MODULE.html" title="cwe_checker_lib::checkers::cwe_78::CWE_MODULE static">CWE_MODULE</a></td><td class="docblock-short"><p>The module name and version</p>
</td></tr></table><h2 id="functions" class="section-header"><a href="#functions">Functions</a></h2>
<table><tr class="module-item"><td><a class="fn" href="fn.check_cwe.html" title="cwe_checker_lib::checkers::cwe_78::check_cwe fn">check_cwe</a></td><td class="docblock-short"><p>This check searches for system calls and sets their parameters as taint source if available.
Then the fixpoint computation is executed and its result may generate cwe warnings if
the parameters can be tracked back to user inputs</p>
</td></tr></table></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../../../" data-current-crate="cwe_checker_lib" data-search-index-js="../../../search-index.js" data-search-js="../../../search.js"></div>
    <script src="../../../main.js"></script></body></html>