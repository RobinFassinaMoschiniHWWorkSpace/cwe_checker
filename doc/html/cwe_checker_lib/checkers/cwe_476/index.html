<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="This module implements a check for CWE-476: NULL Pointer Dereference."><meta name="keywords" content="rust, rustlang, rust-lang, cwe_476"><title>cwe_checker_lib::checkers::cwe_476 - Rust</title><link rel="stylesheet" type="text/css" href="../../../normalize.css"><link rel="stylesheet" type="text/css" href="../../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../../ayu.css" disabled ><script id="default-settings"></script><script src="../../../storage.js"></script><script src="../../../crates.js"></script><noscript><link rel="stylesheet" href="../../../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../../../favicon.svg">
<link rel="alternate icon" type="image/png" href="../../../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../../../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../../../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../../../cwe_checker_lib/index.html'><div class='logo-container rust-logo'><img src='../../../rust-logo.png' alt='logo'></div></a><p class="location">Module cwe_476</p><div class="sidebar-elems"><div class="block items"><ul><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#statics">Statics</a></li><li><a href="#functions">Functions</a></li></ul></div><p class="location"><a href="../../index.html">cwe_checker_lib</a>::<wbr><a href="../index.html">checkers</a></p><div id="sidebar-vars" data-name="cwe_476" data-ty="mod" data-relpath="../"></div><script defer src="../sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../../../brush.svg" width="18" height="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" class="help-button">?</button>
                <a id="settings-menu" href="../../../settings.html"><img src="../../../wheel.svg" width="18" height="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Module <a href="../../index.html">cwe_checker_lib</a>::<wbr><a href="../index.html">checkers</a>::<wbr><a class="mod" href="">cwe_476</a><button id="copy-path" onclick="copy_path(this)">⎘</button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../../src/cwe_checker_lib/checkers/cwe_476.rs.html#1-136" title="goto source code">[src]</a></span></h1><div class="docblock"><p>This module implements a check for CWE-476: NULL Pointer Dereference.</p>
<p>Functions like <code>malloc()</code> may return NULL values instead of pointers to indicate
failed calls. If one tries to access memory through this return value without
checking it for being NULL first, this can crash the program.</p>
<p>See <a href="https://cwe.mitre.org/data/definitions/476.html">https://cwe.mitre.org/data/definitions/476.html</a> for a detailed description.</p>
<h2 id="how-the-check-works" class="section-header"><a href="#how-the-check-works">How the check works</a></h2>
<p>Using dataflow analysis we search for an execution path where a memory access using the return value of
a symbol happens before the return value is checked through a conditional jump instruction.</p>
<h3 id="symbols-configurable-in-configjson" class="section-header"><a href="#symbols-configurable-in-configjson">Symbols configurable in config.json</a></h3>
<p>The symbols are the functions whose return values are assumed to be potential
NULL pointers.</p>
<h2 id="false-positives" class="section-header"><a href="#false-positives">False Positives</a></h2>
<ul>
<li>If a possible NULL pointer is temporarily saved in a memory location
that the <a href="../../analysis/pointer_inference/index.html">Pointer Inference analysis</a> could not track,
the analysis may miss a correct NULL pointer check and thus generate false positives.</li>
<li>The analysis is intraprocedural.
If a parameter to a function is a potential NULL pointer,
this gets flagged as a CWE hit even if the function may expect NULL pointers in its parameters.
If a function returns a potential NULL pointer this gets flagged as a CWE hit,
although the function may be supposed to return potential NULL pointers.</li>
</ul>
<h2 id="false-negatives" class="section-header"><a href="#false-negatives">False Negatives</a></h2>
<ul>
<li>We do not check whether an access to a potential NULL pointer happens regardless
of a prior check.</li>
<li>We do not check whether the conditional jump instruction checks specifically
for the return value being NULL or something else</li>
<li>For functions with more than one return value we do not distinguish between
the return values.</li>
</ul>
</div><h2 id="structs" class="section-header"><a href="#structs">Structs</a></h2>
<table><tr class="module-item"><td><a class="struct" href="struct.Config.html" title="cwe_checker_lib::checkers::cwe_476::Config struct">Config</a></td><td class="docblock-short"><p>The configuration struct</p>
</td></tr></table><h2 id="enums" class="section-header"><a href="#enums">Enums</a></h2>
<table><tr class="module-item"><td><a class="enum" href="enum.Taint.html" title="cwe_checker_lib::checkers::cwe_476::Taint enum">Taint</a></td><td class="docblock-short"><p>An abstract domain representing a value that is either tainted or not.</p>
</td></tr></table><h2 id="statics" class="section-header"><a href="#statics">Statics</a></h2>
<table><tr class="module-item"><td><a class="static" href="static.CWE_MODULE.html" title="cwe_checker_lib::checkers::cwe_476::CWE_MODULE static">CWE_MODULE</a></td><td class="docblock-short"><p>The module name and version</p>
</td></tr></table><h2 id="functions" class="section-header"><a href="#functions">Functions</a></h2>
<table><tr class="module-item"><td><a class="fn" href="fn.check_cwe.html" title="cwe_checker_lib::checkers::cwe_476::check_cwe fn">check_cwe</a></td><td class="docblock-short"><p>Run the CWE check.
We check whether the return values of symbols configurable in the config file are being checked for Null pointers
before any memory access (and thus potential Null pointer dereferences) through these values happen.</p>
</td></tr></table></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../../../" data-current-crate="cwe_checker_lib" data-search-index-js="../../../search-index.js" data-search-js="../../../search.js"></div>
    <script src="../../../main.js"></script></body></html>