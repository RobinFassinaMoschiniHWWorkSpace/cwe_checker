<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Generate control flow graphs out of a program term."><meta name="keywords" content="rust, rustlang, rust-lang, graph"><title>cwe_checker_lib::analysis::graph - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../../../normalize.css"><link rel="stylesheet" type="text/css" href="../../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../../../dark.css" disabled><link rel="stylesheet" type="text/css" href="../../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../../storage.js"></script><script src="../../../crates.js"></script><script defer src="../../../main.js"></script>
    <noscript><link rel="stylesheet" href="../../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../../favicon.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../../cwe_checker_lib/index.html"><div class="logo-container"><img class="rust-logo" src="../../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../../../cwe_checker_lib/index.html"><div class="logo-container"><img class="rust-logo" src="../../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">Module graph</a></h2><div class="sidebar-elems"><section><div class="block"><ul><li><a href="#enums">Enums</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Definitions</a></li></ul></div></section><div id="sidebar-vars" data-name="graph" data-ty="mod" data-relpath="./"></div><script defer src="./sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../../../cwe_checker_lib/index.html"><img class="rust-logo" src="../../../rust-logo.svg" alt="logo"></a><nav class="sub"><div class="theme-picker hidden"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="22" height="22" alt="Pick another theme!" src="../../../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Module <a href="../../index.html">cwe_checker_lib</a>::<wbr><a href="../index.html">analysis</a>::<wbr><a class="mod" href="#">graph</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../../../src/cwe_checker_lib/analysis/graph.rs.html#1-651">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Generate control flow graphs out of a program term.</p>
<p>The generated graphs follow some basic principles:</p>
<ul>
<li><strong>Nodes</strong> denote specific (abstract) points in time during program execution,
i.e. information does not change on a node.
So a basic block itself is not a node,
but the points in time before and after execution of the basic block can be nodes.</li>
<li><strong>Edges</strong> denote either transitions between the points in time of their start and end nodes during program execution
or they denote (artificial) information flow between nodes. See the <code>CRCallStub</code> edges of interprocedural control flow graphs
for an example of an edge that is only meant for information flow and not actual control flow.</li>
</ul>
<h2 id="general-assumptions"><a href="#general-assumptions">General assumptions</a></h2>
<p>The graph construction algorithm assumes
that each basic block of the program term ends with zero, one or two jump instructions.
In the case of two jump instructions the first one is a conditional jump
and the second one is an unconditional jump.
Conditional calls are not supported.
Missing jump instructions are supported to indicate incomplete information about the control flow,
i.e. points where the control flow reconstruction failed.
These points are converted to dead ends in the control flow graphs.</p>
<h2 id="interprocedural-control-flow-graph"><a href="#interprocedural-control-flow-graph">Interprocedural control flow graph</a></h2>
<p>The function <a href="fn.get_program_cfg.html"><code>get_program_cfg</code></a> builds an interprocedural control flow graph out of a program term as follows:</p>
<ul>
<li>Each basic block (<a href="../../../../../doc/images/node_edge.png"><code>image</code></a>) is converted into two nodes, <em>BlkStart</em> and <em>BlkEnd</em>,
and a <em>block</em> edge from <em>BlkStart</em> to <em>BlkEnd</em>.</li>
<li>Jumps and calls inside the program are converted to <em>Jump</em> or <em>Call</em> edges from the <em>BlkEnd</em> node of their source
to the <em>BlkStart</em> node of their target (which is the first block of the target function in case of calls).</li>
<li>Calls to library functions (<a href="../../../../../doc/images/extern_calls.png"><code>image</code></a>) outside the program are converted to <em>ExternCallStub</em> edges
from the <em>BlkEnd</em> node of the callsite to the <em>BlkStart</em> node of the basic block the call returns to
(if the call returns at all).</li>
<li>Right now indirect calls are handled as if they were extern calls, i.e. an <em>ExternCallStub</em> edge is added.
This behaviour will change in the future, when better indirect call handling is implemented.</li>
<li>For each in-program call (<a href="../../../../../doc/images/internal_function_call.png"><code>image</code></a>) and corresponding return jump two nodes and four edges are generated:
<ul>
<li>An artificial node <em>CallReturn</em> and node <em>CallSource</em></li>
<li>A <em>CRCallStub</em> edge from the <em>BlkEnd</em> node of the callsite to <em>CallReturn</em></li>
<li>A <em>CRReturnStub</em> edge from the <em>BlkEnd</em> node of the returning from block to <em>CallReturn</em></li>
<li>A <em>ReturnCombine</em> edge from <em>CallReturn</em> to the <em>BlkStart</em> node of the returned to block.</li>
<li>A <em>CallCombine</em> edge from the <em>BlkEnd</em> node to the <em>CallSource</em> node.</li>
</ul>
</li>
</ul>
<p>The artificial <em>CallReturn</em> nodes enable enriching the information flowing through a return edge
with information recovered from the corresponding callsite during a fixpoint computation.</p>
</div></details><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Edge.html" title="cwe_checker_lib::analysis::graph::Edge enum">Edge</a></div><div class="item-right docblock-short"><p>The edge type of an interprocedural fixpoint graph.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Node.html" title="cwe_checker_lib::analysis::graph::Node enum">Node</a></div><div class="item-right docblock-short"><p>The node type of an interprocedural control flow graph</p>
</div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.get_entry_nodes_of_subs.html" title="cwe_checker_lib::analysis::graph::get_entry_nodes_of_subs fn">get_entry_nodes_of_subs</a></div><div class="item-right docblock-short"><p>Returns a map from function TIDs to the node index of the <code>BlkStart</code> node of the first block in the function.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.get_program_cfg.html" title="cwe_checker_lib::analysis::graph::get_program_cfg fn">get_program_cfg</a></div><div class="item-right docblock-short"><p>Build the interprocedural control flow graph for a program term.</p>
</div></div></div><h2 id="types" class="small-section-header"><a href="#types">Type Definitions</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="type" href="type.Graph.html" title="cwe_checker_lib::analysis::graph::Graph type">Graph</a></div><div class="item-right docblock-short"><p>The graph type of an interprocedural control flow graph</p>
</div></div></div></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../../../" data-current-crate="cwe_checker_lib" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.60.0 (7737e0b5c 2022-04-04)" ></div>
</body></html>