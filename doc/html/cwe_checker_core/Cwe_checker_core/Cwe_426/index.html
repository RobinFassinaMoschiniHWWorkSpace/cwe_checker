<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Cwe_426 (cwe_checker_core.Cwe_checker_core.Cwe_426)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">cwe_checker_core</a> &#x00BB; <a href="../index.html">Cwe_checker_core</a> &#x00BB; Cwe_426</nav><h1>Module <code>Cwe_checker_core.Cwe_426</code></h1><nav class="toc"><ul><li><a href="#how-the-check-works">How the check works</a></li><li><a href="#false-positives">False Positives</a></li><li><a href="#false-negatives">False Negatives</a></li></ul></nav></header><aside><p>This module implements a check for CWE-426: Untrusted Search Path.</p><p>Basically, the program searches for critical resources on an untrusted search path that can be adjusted by an adversary. For example, see Nebula Level 1 (<a href="https://exploit-exercises.com/nebula/level01/">https://exploit-exercises.com/nebula/level01/</a>).</p><p>According to the manual page of system() the following problems can arise: &quot;Do not use system() from a program with set-user-ID or set-group-ID privileges, because strange values for some environment variables might be used to subvert system integrity. Use the exec(3) family of functions instead, but not execlp(3) or execvp(3). system() will not, in fact, work properly from programs with set-user-ID or set-group-ID privileges on systems on which /bin/sh is bash version 2, since bash 2 drops privileges on startup. (Debian uses a modified bash which does not do this when invoked as sh.)&quot;</p><p>See <a href="https://cwe.mitre.org/data/definitions/426.html">https://cwe.mitre.org/data/definitions/426.html</a> for a detailed description.</p></aside><section><header><h2 id="how-the-check-works"><a href="#how-the-check-works" class="anchor"></a>How the check works</h2><p>We check whether a function that calls a privilege-changing function (configurable in config.json) also calls system().</p></header></section><section><header><h2 id="false-positives"><a href="#false-positives" class="anchor"></a>False Positives</h2><ul><li>If the call to system() happens before the privilege-changing function, the call may not be used for privilege escalation</li></ul></header></section><section><header><h2 id="false-negatives"><a href="#false-negatives" class="anchor"></a>False Negatives</h2><ul><li>If the calls to the privilege-changing function and system() happen in different functions, the calls will not be flagged as a CWE-hit.</li><li>This check only finds potential privilege escalation bugs, but other types of bugs can also be triggered by untrusted search paths.</li></ul></header><dl><dt class="spec value" id="val-name"><a href="#val-name" class="anchor"></a><code><span class="keyword">val</span> name : string</code></dt><dt class="spec value" id="val-version"><a href="#val-version" class="anchor"></a><code><span class="keyword">val</span> version : string</code></dt><dt class="spec value" id="val-check_cwe"><a href="#val-check_cwe" class="anchor"></a><code><span class="keyword">val</span> check_cwe : <span>Bap.Std.program Bap.Std.term</span> <span>&#45;&gt;</span> Bap.Std.project <span>&#45;&gt;</span> <span>Bap.Std.word Bap.Std.Tid.Map.t</span> <span>&#45;&gt;</span> <span><span>string list</span> list</span> <span>&#45;&gt;</span> <span>string list</span> <span>&#45;&gt;</span> unit</code></dt></dl></section></div></body></html>