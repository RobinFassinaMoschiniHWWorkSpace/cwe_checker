<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Symbol_utils (cwe_checker_core.Cwe_checker_core.Symbol_utils)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">cwe_checker_core</a> &#x00BB; <a href="../index.html">Cwe_checker_core</a> &#x00BB; Symbol_utils</nav><h1>Module <code>Cwe_checker_core.Symbol_utils</code></h1></header><aside><p>This module implements functionality to work with symbols (e.g. malloc).</p></aside><dl><dt class="spec type" id="type-concrete_call"><a href="#type-concrete_call" class="anchor"></a><code><span class="keyword">type</span> concrete_call</code><code> = </code><code>{</code><table class="record"><tr id="type-concrete_call.call_site" class="anchored"><td class="def field"><a href="#type-concrete_call.call_site" class="anchor"></a><code>call_site : Bap.Std.tid;</code></td></tr><tr id="type-concrete_call.symbol_address" class="anchored"><td class="def field"><a href="#type-concrete_call.symbol_address" class="anchor"></a><code>symbol_address : Bap.Std.tid;</code></td></tr><tr id="type-concrete_call.name" class="anchored"><td class="def field"><a href="#type-concrete_call.name" class="anchor"></a><code>name : string;</code></td></tr></table><code>}</code></dt><dt class="spec type" id="type-symbol"><a href="#type-symbol" class="anchor"></a><code><span class="keyword">type</span> symbol</code><code> = </code><code>{</code><table class="record"><tr id="type-symbol.address" class="anchored"><td class="def field"><a href="#type-symbol.address" class="anchor"></a><code>address : <span>Bap.Std.tid option</span>;</code></td></tr><tr id="type-symbol.name" class="anchored"><td class="def field"><a href="#type-symbol.name" class="anchor"></a><code>name : string;</code></td></tr></table><code>}</code></dt><dd><p>This type represents a symbol like malloc or memcpy.</p></dd></dl><dl><dt class="spec value" id="val-find_symbol"><a href="#val-find_symbol" class="anchor"></a><code><span class="keyword">val</span> find_symbol : <span>Bap.Std.program Bap.Std.term</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>Bap.Std.tid option</span></code></dt><dd><p>Finds a symbol string in a program and returns its IR address (tid).</p></dd></dl><dl><dt class="spec value" id="val-build_symbols"><a href="#val-build_symbols" class="anchor"></a><code><span class="keyword">val</span> build_symbols : <span>string list</span> <span>&#45;&gt;</span> <span>Bap.Std.program Bap.Std.term</span> <span>&#45;&gt;</span> <span><a href="index.html#type-symbol">symbol</a> list</span></code></dt><dd><p>builds a list of symbols from a list of strings for a given program TODO: maybe another data structure like a hashmap would be better.</p></dd></dl><dl><dt class="spec value" id="val-get_symbol"><a href="#val-get_symbol" class="anchor"></a><code><span class="keyword">val</span> get_symbol : Bap.Std.tid <span>&#45;&gt;</span> <span><a href="index.html#type-symbol">symbol</a> list</span> <span>&#45;&gt;</span> <span><a href="index.html#type-symbol">symbol</a> option</span></code></dt><dd><p>Gets a symbol from a symbol list</p></dd></dl><dl><dt class="spec value" id="val-get_symbol_of_string"><a href="#val-get_symbol_of_string" class="anchor"></a><code><span class="keyword">val</span> get_symbol_of_string : <span>Bap.Std.program Bap.Std.term</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><a href="index.html#type-symbol">symbol</a> option</span></code></dt><dd><p>Gets a symbol from a string</p></dd></dl><dl><dt class="spec value" id="val-get_symbol_name_from_jmp"><a href="#val-get_symbol_name_from_jmp" class="anchor"></a><code><span class="keyword">val</span> get_symbol_name_from_jmp : Bap.Std.Jmp.t <span>&#45;&gt;</span> <span><a href="index.html#type-symbol">symbol</a> list</span> <span>&#45;&gt;</span> string</code></dt><dd><p>Given a JMP and symbol list, it returns its name as string. Use only if you are sure that the JMP calls a symbol.</p></dd></dl><dl><dt class="spec value" id="val-sub_calls_symbol"><a href="#val-sub_calls_symbol" class="anchor"></a><code><span class="keyword">val</span> sub_calls_symbol : <span>Bap.Std.program Bap.Std.term</span> <span>&#45;&gt;</span> <span>Bap.Std.sub Bap.Std.term</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> bool</code></dt><dd><p>Checks if a subfunction calls a symbol.</p></dd></dl><dl><dt class="spec value" id="val-calls_callsite_symbol"><a href="#val-calls_callsite_symbol" class="anchor"></a><code><span class="keyword">val</span> calls_callsite_symbol : Bap.Std.Jmp.t <span>&#45;&gt;</span> <a href="index.html#type-symbol">symbol</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Checks if a callsite calls a symbol</p></dd></dl><dl><dt class="spec value" id="val-call_finder"><a href="#val-call_finder" class="anchor"></a><code><span class="keyword">val</span> call_finder : <span><span><span>(Bap.Std.tid * Bap.Std.tid)</span> list</span> Bap.Std.Term.visitor</span></code></dt><dd><p>This function finds all (direct) calls in a program. It returns a list of tuples of (callsite, address).</p></dd></dl><dl><dt class="spec value" id="val-transform_call_to_concrete_call"><a href="#val-transform_call_to_concrete_call" class="anchor"></a><code><span class="keyword">val</span> transform_call_to_concrete_call : <span>(Bap.Std.tid * Bap.Std.tid)</span> <span>&#45;&gt;</span> <span><a href="index.html#type-symbol">symbol</a> list</span> <span>&#45;&gt;</span> <a href="index.html#type-concrete_call">concrete_call</a></code></dt><dd><p>Transform a call (e.g. found with call_finder) to concrete_call with the symbol resolved.</p></dd></dl><dl><dt class="spec value" id="val-filter_calls_to_symbols"><a href="#val-filter_calls_to_symbols" class="anchor"></a><code><span class="keyword">val</span> filter_calls_to_symbols : <span><span>(Bap.Std.tid * Bap.Std.tid)</span> list</span> <span>&#45;&gt;</span> <span><a href="index.html#type-symbol">symbol</a> list</span> <span>&#45;&gt;</span> <span><a href="index.html#type-concrete_call">concrete_call</a> list</span></code></dt><dd><p>Filters out all calls (callsite, target) that do not call to a known symbol.</p></dd></dl><dl><dt class="spec value" id="val-is_interesting_callsite"><a href="#val-is_interesting_callsite" class="anchor"></a><code><span class="keyword">val</span> is_interesting_callsite : Bap.Std.Jmp.t <span>&#45;&gt;</span> <span><a href="index.html#type-concrete_call">concrete_call</a> list</span> <span>&#45;&gt;</span> bool</code></dt><dd><p>Checks if a callsite is in a list of (interesting) concrete_calls</p></dd></dl><dl><dt class="spec value" id="val-check_calls"><a href="#val-check_calls" class="anchor"></a><code><span class="keyword">val</span> check_calls : <span><a href="index.html#type-concrete_call">concrete_call</a> list</span> <span>&#45;&gt;</span> <span>Bap.Std.program Bap.Std.term</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'c</span> <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span>Bap.Std.program Bap.Std.term</span> <span>&#45;&gt;</span> <span>Bap.Std.sub Bap.Std.term</span> <span>&#45;&gt;</span> <span>Bap.Std.blk Bap.Std.term</span> <span>&#45;&gt;</span> <span>Bap.Std.jmp Bap.Std.term</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'c</span> <span>&#45;&gt;</span> unit)</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>TODO</p></dd></dl><dl><dt class="spec value" id="val-get_direct_callsites_of_sub"><a href="#val-get_direct_callsites_of_sub" class="anchor"></a><code><span class="keyword">val</span> get_direct_callsites_of_sub : <span>Bap.Std.sub Bap.Std.term</span> <span>&#45;&gt;</span> <span><span>Bap.Std.jmp Bap.Std.term</span> Core_kernel.Sequence.t</span></code></dt><dd><p>Returns a sequence of all (direct) callsites in a subfunction</p></dd></dl><dl><dt class="spec value" id="val-get_symbol_call_count_of_sub"><a href="#val-get_symbol_call_count_of_sub" class="anchor"></a><code><span class="keyword">val</span> get_symbol_call_count_of_sub : string <span>&#45;&gt;</span> Bap.Std.Sub.t <span>&#45;&gt;</span> Bap.Std.Program.t <span>&#45;&gt;</span> int</code></dt><dd><p>Returns call count of symbol in function</p></dd></dl><dl><dt class="spec value" id="val-extract_direct_call_tid_from_block"><a href="#val-extract_direct_call_tid_from_block" class="anchor"></a><code><span class="keyword">val</span> extract_direct_call_tid_from_block : <span>Bap.Std.blk Bap.Std.term</span> <span>&#45;&gt;</span> <span>Bap.Std.tid option</span></code></dt><dd><p>Returns Some(target tid) if the block contains a direct call or None if it does not.</p></dd></dl><dl><dt class="spec value" id="val-get_program_entry_points"><a href="#val-get_program_entry_points" class="anchor"></a><code><span class="keyword">val</span> get_program_entry_points : <span>Bap.Std.program Bap.Std.term</span> <span>&#45;&gt;</span> <span><span>Bap.Std.sub Bap.Std.term</span> Bap.Std.Seq.t</span></code></dt><dd><p>Returns a sequence of all entry points of the program. TODO: The _start entry point usually calls a libc-function which then calls the main function. Since right now only direct calls are tracked, our graph traversal may never find the main function. For now, we add it by hand to the entry points.</p></dd></dl><dl><dt class="spec value" id="val-stack_register"><a href="#val-stack_register" class="anchor"></a><code><span class="keyword">val</span> stack_register : Bap.Std.Project.t <span>&#45;&gt;</span> Bap.Std.Var.t</code></dt><dd><p>Returns the stack register on the architecture of the given project.</p></dd></dl><dl><dt class="spec value" id="val-flag_register_list"><a href="#val-flag_register_list" class="anchor"></a><code><span class="keyword">val</span> flag_register_list : Bap.Std.Project.t <span>&#45;&gt;</span> <span>Bap.Std.Var.t list</span></code></dt><dd><p>Returns a list of the known flag registers on the architecture of the given project. TODO: Right now it only returns flag registers that exist on all architectures. We should add known architecture dependend flag registers, too.</p></dd></dl><dl><dt class="spec value" id="val-arch_pointer_size_in_bytes"><a href="#val-arch_pointer_size_in_bytes" class="anchor"></a><code><span class="keyword">val</span> arch_pointer_size_in_bytes : Bap.Std.Project.t <span>&#45;&gt;</span> int</code></dt><dd><p>Returns the pointer size in bytes on the architecture of the given project.</p></dd></dl></div></body></html>