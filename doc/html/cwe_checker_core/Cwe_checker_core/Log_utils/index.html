<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Log_utils (cwe_checker_core.Cwe_checker_core.Log_utils)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">cwe_checker_core</a> &#x00BB; <a href="../index.html">Cwe_checker_core</a> &#x00BB; Log_utils</nav><h1>Module <code>Cwe_checker_core.Log_utils</code></h1></header><aside><p>This module implements the logging logic or cwe_checker.</p><p>Each check may produce a CweWarning, which holds information regarding the current CWE hit. These CweWarnings are stored globally so that we can output at the very end. This may be necessary, for instance, when the output should be a JSON document.</p><p>CWE checks can utilize the function cwe_warning_factory to create CweWarning objects and the function collect_cwe_warning to store them globally.</p><p>At the moment, cwe_checker supports plain text and JSON output. The corresponding functions are emit_native and emit_json.</p><p>In addition, there are several functions (debug, error, info) to notify the user of certain events. Note that these functions may pollute the output.</p></aside><div class="spec module" id="module-CweWarning"><a href="#module-CweWarning" class="anchor"></a><code><span class="keyword">module</span> <a href="CweWarning/index.html">CweWarning</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec module" id="module-CheckPath"><a href="#module-CheckPath" class="anchor"></a><code><span class="keyword">module</span> <a href="CheckPath/index.html">CheckPath</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><dl><dt class="spec value" id="val-turn_off_logging"><a href="#val-turn_off_logging" class="anchor"></a><code><span class="keyword">val</span> turn_off_logging : unit <span>&#45;&gt;</span> unit</code></dt><dd><p>This function turns on or off the logging of debug, error, and info messages to STDOUT / STDERR. Use if you do not want to pollute your JSON output when outputting to STDOUT.</p></dd></dl><dl><dt class="spec value" id="val-cwe_warning_factory"><a href="#val-cwe_warning_factory" class="anchor"></a><code><span class="keyword">val</span> cwe_warning_factory : string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>?&#8288;other:<span><span>string list</span> list</span></span> <span>&#45;&gt;</span> <span>?&#8288;addresses:<span>string list</span></span> <span>&#45;&gt;</span> <span>?&#8288;tids:<span>string list</span></span> <span>&#45;&gt;</span> <span>?&#8288;symbols:<span>string list</span></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="CweWarning/index.html#type-t">CweWarning.t</a></code></dt><dd><p>Factory function to easily build an element of type CweWarning.t. It takes the following input parameters:</p><ul><li>name: name of the CWE</li><li>version: version of the cwe_check</li><li>other: list of abritrary string elements (use as needed)</li><li>addresses: list of relevant assembly addresses as strings</li><li>tids: list of relevant TIDs as strings</li><li>symbols: list of associated symbols as strings</li><li>description: string description of the CWE</li></ul><p>Factory function to easily build an element of type CheckPath.t. It takes the following input parameters:</p><ul><li>path: a list of strings of node on the path</li><li>path_str: a string of the path between source and destination</li><li>source: symbol of source</li><li>source_addr: assembly address of source</li><li>destination: symbol / address of destination</li><li>destination_addr: assembly address of destination</li></ul></dd></dl><dl><dt class="spec value" id="val-check_path_factory"><a href="#val-check_path_factory" class="anchor"></a><code><span class="keyword">val</span> check_path_factory : <span>?&#8288;path:<span>string list</span></span> <span>&#45;&gt;</span> <span>?&#8288;path_str:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="CheckPath/index.html#type-t">CheckPath.t</a></code></dt><dd><p>Factory function to easily build an element of type CheckPath.t. It takes the following input parameters:</p><ul><li>path: a list of strings of node on the path</li><li>path_str: a string of the path between source and destination</li><li>source: symbol of source</li><li>source_addr: assembly address of source</li><li>destination: symbol / address of destination</li><li>destination_addr: assembly address of destination</li></ul></dd></dl><dl><dt class="spec value" id="val-collect_cwe_warning"><a href="#val-collect_cwe_warning" class="anchor"></a><code><span class="keyword">val</span> collect_cwe_warning : <a href="CweWarning/index.html#type-t">CweWarning.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Add one CweWarning.t element to an internal store. All elements are emited by calling one of the emit_* functions.</p><p>Add one CheckPath.t element to an internal store. All elements are emited by calling one of the emit_* functions.</p></dd></dl><dl><dt class="spec value" id="val-collect_check_path"><a href="#val-collect_check_path" class="anchor"></a><code><span class="keyword">val</span> collect_check_path : <a href="CheckPath/index.html#type-t">CheckPath.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Add one CheckPath.t element to an internal store. All elements are emited by calling one of the emit_* functions.</p><p>Returns the internal store of CweWarning.t elements as a list.</p></dd></dl><dl><dt class="spec value" id="val-get_cwe_warnings"><a href="#val-get_cwe_warnings" class="anchor"></a><code><span class="keyword">val</span> get_cwe_warnings : unit <span>&#45;&gt;</span> <span><a href="CweWarning/index.html#type-t">CweWarning.t</a> list</span></code></dt><dd><p>Returns the internal store of CweWarning.t elements as a list.</p></dd></dl><dl><dt class="spec value" id="val-emit_json"><a href="#val-emit_json" class="anchor"></a><code><span class="keyword">val</span> emit_json : string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p>Emits stored CweWarning.t and CheckPath.t elements as json. target_path is the path of the current BAP project and out_path is the path a json output file.</p><p>Emits stored CweWarning.t and CheckPath.t elements. target_path is the path of the current BAP project and out_path is the path an output file.</p></dd></dl><dl><dt class="spec value" id="val-emit_native"><a href="#val-emit_native" class="anchor"></a><code><span class="keyword">val</span> emit_native : string <span>&#45;&gt;</span> unit</code></dt><dd><p>Emits stored CweWarning.t and CheckPath.t elements. target_path is the path of the current BAP project and out_path is the path an output file.</p></dd></dl><dl><dt class="spec value" id="val-debug"><a href="#val-debug" class="anchor"></a><code><span class="keyword">val</span> debug : string <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-error"><a href="#val-error" class="anchor"></a><code><span class="keyword">val</span> error : string <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-info"><a href="#val-info" class="anchor"></a><code><span class="keyword">val</span> info : string <span>&#45;&gt;</span> unit</code></dt></dl></div></body></html>